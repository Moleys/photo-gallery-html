var commentList,pageID=1,totalChat=1;function getQueryVariable(e){for(var a=window.location.search.substring(1).split("&"),t=0;t<a.length;t++){var n=a[t].split("=");if(n[0]==e)return n[1]}return!1}function updatePageURL(e){if(history.pushState){var a=window.location.protocol+"//"+window.location.host+window.location.pathname+"?page="+e;window.history.pushState({path:a},"",a)}}function phanTrangChat(e,a){var t=1;t=e%24>0?Math.floor(e/24)+1:Math.floor(e/24),console.log("Tong chat"+e),console.log("Tong page "+t),$("#phan-trang").empty();var n=a-1,o=a-2,l=Number(a)+1,s=Number(a)+2;a>1&&$("#phan-trang").append('<li class="page-item"><a class="button bordered" onclick="getComments('+e+","+n+')" >«</a></li>'),a>3&&$("#phan-trang").append('<li class="page-item"><a class="button bordered" onclick="getComments('+e+',1)" >1</a></li>'),a>4&&$("#phan-trang").append("..."),a>2&&$("#phan-trang").append('<li class="page-item"><a class="button bordered" onclick="getComments('+e+","+o+')" >'+o+"</a></li>"),a>1&&$("#phan-trang").append('<li class="page-item"><a class="button bordered" onclick="getComments('+e+","+n+')" >'+n+"</a></li>"),$("#phan-trang").append('<li class="page-item"><a disabled class="primary button bordered" href="#">'+a+"</a></li>"),a<t-1&&$("#phan-trang").append('<li class="page-item"><a class="button bordered" onclick="getComments('+e+","+l+')" >'+l+"</a></li>"),a<t-2&&$("#phan-trang").append('<li class="page-item"><a class="button bordered" onclick="getComments('+e+","+s+') ">'+s+"</a></li>"),a<t-3&&$("#phan-trang").append("..."),a<t&&$("#phan-trang").append('<li class="page-item"><a class="button bordered" onclick="getComments('+e+","+t+')" >'+t+"</a></li>"),a<t&&$("#phan-trang").append('<li class="page-item"><a class="button bordered" onclick="getComments('+e+","+l+')" >»</a>'),$("#phan-trang").append('<br/><li class="page-item"><input type="number" id="ano" name="page" min="1" max="'+t+'"></li><li class="page-item"><input type="button" onclick="getPage('+e+')" class="button bordered" value="Go"></li>')}function getPage(e){getComments(e,$("#ano").val())}function getCommentElementHTML(e){var a=e.replace(".jpg","l.jpg").replace(".png","l.png").replace(".gif","l.gif").replace(".jpeg","l.jpeg");return $(`<div class="masonry-item"><a href="${validator.escape(e)}" class="swipebox" title=""><img class="pdr-c2tn-200xxsw" loading="lazy" src="${validator.escape(a)}" alt="" /></a></div>`)}function displayComments(e){e=`url\n${e}`,commentList=$.csv.toObjects(e),getQueryVariable("page")&&(pageID=getQueryVariable("page")),commentList.reverse(),getComments(totalChat=commentList.length,pageID)}function getComments(e,a){$("#commentSection").html(""),document.getElementById("commentSection").scrollIntoView(),updatePageURL(a);var t,n=24*(a-1),o=24*a-1,l=n;for(phanTrangChat(e,a),t=n;t<=o;t++){if(l>=e){console.log("Load xong, id cuoi "+l);break}l++;var s=getCommentElementHTML(commentList[t].url);$("#commentSection").append(s),s.fadeIn(),$("#no-comments").hide()}}function loadComments(){var e=encodeURIComponent("SELECT B");fetch(`https://docs.google.com/spreadsheets/d/1EzvHQFV9wC-OmJ_rqzHRSMnQv-gCn8oPKuJEaC8ezZY/gviz/tq?tqx=out:csv&sheet=comments&tq=${e}&headers=0`).then((e=>e.text())).then((e=>displayComments(e)))}loadComments(),jQuery(".swipebox").swipebox();
